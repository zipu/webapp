{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Trading Journal</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom Mobile CSS -->
  <link rel="stylesheet" href="{% static 'css/trading_mobile.css' %}">

  <!-- PWA Manifest -->
  <link rel="manifest" href="{% static 'manifest.json' %}">
  <meta name="theme-color" content="#2962FF">
  {# <link rel="apple-touch-icon" href="{% static 'icons/apple-touch-icon.png' %}"> #}

  <!-- Lightweight Charts (v3.8 - stable API) -->
  <script src="https://unpkg.com/lightweight-charts@3.8.0/dist/lightweight-charts.standalone.production.js"></script>

  {% block extra_head %}{% endblock %}
</head>
<body>
  <!-- ìƒë‹¨ í—¤ë” (ì‘ê²Œ) -->
  <header class="app-header">
    <h1>ğŸ“Š Trading Journal</h1>
  </header>

  <!-- ë©”ì¸ ì»¨í…ì¸  ì˜ì—­ -->
  <main class="app-content">
    {% block content %}{% endblock %}
  </main>

  <!-- í•˜ë‹¨ ê³ ì • ë„¤ë¹„ê²Œì´ì…˜ -->
  <nav class="bottom-nav">
    <a href="{% url 'futures_home' %}" class="nav-item {% if request.resolver_match.url_name == 'futures_home' %}active{% endif %}">
      <span class="icon">ğŸ </span>
      <span class="label">í™ˆ</span>
    </a>
    <a href="{% url 'futurestrade' page=1 %}" class="nav-item {% if 'trade' in request.path %}active{% endif %}">
      <span class="icon">ğŸ“Š</span>
      <span class="label">ê±°ë˜</span>
    </a>
    <a href="{% url 'insights' %}" class="nav-item {% if request.resolver_match.url_name == 'insights' %}active{% endif %}">
      <span class="icon">ğŸ’¡</span>
      <span class="label">ì¸ì‚¬ì´íŠ¸</span>
    </a>
    <a href="{% url 'analysis' %}" class="nav-item {% if request.resolver_match.url_name == 'analysis' %}active{% endif %}">
      <span class="icon">ğŸ“ˆ</span>
      <span class="label">ë¶„ì„</span>
    </a>
    <a href="{% url 'settings' %}" class="nav-item {% if request.resolver_match.url_name == 'settings' %}active{% endif %}">
      <span class="icon">âš™ï¸</span>
      <span class="label">ì„¤ì •</span>
    </a>
  </nav>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  {% block script %}{% endblock %}

  <!-- PWA Install Prompt (Optional) -->
  <script>
    // Service Worker ë“±ë¡ (ë‚˜ì¤‘ì— ì¶”ê°€ ì‹œ)
    // if ('serviceWorker' in navigator) {
    //   window.addEventListener('load', () => {
    //     navigator.serviceWorker.register('/static/sw.js')
    //       .then(reg => console.log('SW registered'))
    //       .catch(err => console.log('SW error:', err));
    //   });
    // }

    // PWA Install Prompt
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      // ì—¬ê¸°ì— ì„¤ì¹˜ ë²„íŠ¼ì„ ë³´ì—¬ì¤„ ìˆ˜ ìˆìŒ
      console.log('PWA install prompt ready');
    });
  </script>
</body>
</html>
